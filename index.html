<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ðŸ”¥ Global Crypto Pulse</title>
  <script src="https://cdn.jsdelivr.net/npm/tailwindcss@2.1.2/dist/tailwind.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/framer-motion/dist/framer-motion.js"></script>
  <style>
    /* Add any custom styles here */
  </style>
</head>
<body class="bg-gradient-to-r from-blue-100 via-blue-200 to-blue-300">
  <div class="min-h-screen flex flex-col items-center justify-center p-6">
    <!-- Theme Toggle Button -->
    <button onclick="toggleTheme()" class="absolute top-6 right-6 bg-blue-500 text-white py-2 px-4 rounded-md transition duration-300 transform hover:scale-105">
      ðŸŒ™ Toggle Theme
    </button>
    
    <div class="max-w-4xl w-full bg-white rounded-xl shadow-lg p-8 transform transition-all duration-500 ease-in-out hover:scale-105">
      <h2 class="text-3xl font-bold text-center text-blue-700 mb-6">ðŸ”¥ Global Crypto Pulse</h2>
      <!-- Search Input -->
      <div class="relative">
        <input type="text" id="search" class="w-full p-4 rounded-md border-2 border-gray-300 focus:outline-none focus:border-blue-500 transition duration-300" placeholder="Search for a cryptocurrency..." />
        <div id="suggestions" class="absolute top-full left-0 w-full mt-2 rounded-md bg-white shadow-lg max-h-0 opacity-0 pointer-events-none transition-all duration-300 ease-in-out"></div>
      </div>
      
      <!-- Currency Selection -->
      <div class="mt-4 flex justify-center">
        <label for="currency" class="text-lg text-blue-700">Select Currency:</label>
        <select id="currency" class="ml-4 p-2 rounded-md border-2 border-gray-300 focus:outline-none focus:border-blue-500 transition duration-300">
          <option value="usd">USD ($)</option>
          <option value="eur">EUR (â‚¬)</option>
          <option value="inr">INR (â‚¹)</option>
          <option value="gbp">GBP (Â£)</option>
        </select>
      </div>
      
      <!-- Trending Coins Section -->
      <div id="live-tracking" class="mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
    </div>
  </div>

  <script>
    let allCoins = [];
    let selectedCurrency = 'usd';

    async function fetchAllCoins() {
      const res = await fetch("https://api.coingecko.com/api/v3/coins/list");
      const coins = await res.json();
      allCoins = coins;
    }

    async function fetchTrending() {
      const res = await fetch("https://api.coingecko.com/api/v3/search/trending");
      const json = await res.json();
      return json.coins.map(c => c.item);
    }

    async function showTopTrending() {
      const top = await fetchTrending();
      const storedCoins = ["bitcoin", "ethereum", "dogecoin", "litecoin", "binancecoin"];
      const allCoinsToTrack = top.slice(0, 5).concat(storedCoins);
      allCoinsToTrack.forEach(coin => {
        showLivePrice(coin.id, coin.name, coin.symbol);
      });
    }

    async function showLivePrice(cryptoId, name, symbol) {
      const container = document.getElementById("live-tracking");

      const card = document.createElement("div");
      card.classList.add("bg-white", "p-6", "rounded-lg", "shadow-md", "transform", "transition-all", "duration-500", "ease-in-out", "hover:scale-105", "flex", "flex-col", "items-center");
      card.innerHTML = `
        <div class="font-semibold text-xl text-blue-700">${name} (${symbol.toUpperCase()})</div>
        <div class="text-2xl text-gray-800 mt-4" id="price-${cryptoId}">$0.00</div>
      `;
      container.appendChild(card);

      async function updatePrice() {
        const price = await fetchCrypto(cryptoId);
        if (price !== null) {
          const symbolMap = { usd: '$', eur: 'â‚¬', inr: 'â‚¹', gbp: 'Â£' };
          const symbolChar = symbolMap[selectedCurrency] || '';
          document.getElementById(`price-${cryptoId}`).innerText = `${symbolChar}${price}`;
        }
      }

      await updatePrice();
      setInterval(updatePrice, 60000);
    }

    async function fetchCrypto(cryptoId) {
      const res = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${cryptoId}&vs_currencies=${selectedCurrency}`);
      const data = await res.json();
      return data[cryptoId]?.[selectedCurrency] ?? null;
    }

    document.getElementById("search").addEventListener("input", () => {
      const value = document.getElementById("search").value.toLowerCase();
      const filtered = allCoins.filter(c => 
        c.name.toLowerCase().includes(value) || 
        c.symbol.toLowerCase().includes(value)
      ).slice(0, 5);

      const suggestionsBox = document.getElementById("suggestions");
      suggestionsBox.innerHTML = "";
      suggestionsBox.style.maxHeight = "300px";
      suggestionsBox.style.opacity = "1";
      suggestionsBox.style.pointerEvents = "auto";
      suggestionsBox.style.transition = "all 0.5s ease-out";

      filtered.forEach(coin => {
        const div = document.createElement("div");
        div.textContent = `${coin.name} (${coin.symbol.toUpperCase()})`;
        div.classList.add("p-4", "cursor-pointer", "hover:bg-blue-200");
        div.onclick = () => {
          showLivePrice(coin.id, coin.name, coin.symbol);
          suggestionsBox.innerHTML = "";
        }
        suggestionsBox.appendChild(div);
      });
    });

    document.getElementById("currency").addEventListener("change", () => {
      selectedCurrency = document.getElementById("currency").value;
      showTopTrending();
    });

    function toggleTheme() {
      document.body.classList.toggle("bg-gray-800");
      document.body.classList.toggle("text-white");
    }

    fetchAllCoins();
    showTopTrending();
  </script>
</body>
</html>
